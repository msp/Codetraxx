var asynth = require('../');
var state = {};

var s = asynth(function (note, t) {
    var freq = 440 * Math.pow(2, (note.key - 49) / 12);
    
    var s = state[note.key];
    if (!s) {
        s = state[note.key] = { count: 0, value: 0 };
    }
    s.value = Math.sin(2 * Math.PI * t * freq);
    return Math.sqrt(s.value) * Math.min(1, 1 / Math.pow(note.elapsed * 4, 2));
});

s.play();
